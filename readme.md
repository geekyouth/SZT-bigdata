# SZT-bigdata æ·±åœ³åœ°é“å¤§æ•°æ®å®¢æµåˆ†æç³»ç»Ÿ ğŸš‡ğŸš‡ğŸš‡

<div align="center">
	<a href="https://github.com/geekyouth/SZT-bigdata" target="_blank">
		<img src=".file/.doc/full-logo.png" alt="logo">
	</a>
</div>

---

<div align="center">
	<a href="https://github.com/geekyouth/SZT-bigdata/stargazers" >   
		<img src="https://img.shields.io/github/stars/geekyouth/SZT-bigdata?style=for-the-badge">
	</a>	
	<a href="https://github.com/geekyouth/SZT-bigdata/network/members" > 
		<img src="https://img.shields.io/github/forks/geekyouth/SZT-bigdata?style=for-the-badge">
	</a>	
	<a href="https://github.com/geekyouth/SZT-bigdata/watchers" >
		<img src="https://img.shields.io/github/watchers/geekyouth/SZT-bigdata?style=for-the-badge">
	</a>	
	<a href="https://github.com/geekyouth/SZT-bigdata/releases" >
		<img src="https://img.shields.io/github/v/release/geekyouth/SZT-bigdata?style=for-the-badge">
	</a>	
	<a href="https://github.com/geekyouth/SZT-bigdata/issues" >  
		<img src="https://img.shields.io/github/issues/geekyouth/SZT-bigdata?style=for-the-badge">
	</a>	
	<a href="https://github.com/geekyouth/SZT-bigdata/blob/master/LICENSE" >
		<img src="https://img.shields.io/github/license/geekyouth/SZT-bigdata?style=for-the-badge">
	</a>	
	<br/>
	<a href="https://java666.cn" target="_blank">
		<img src="https://img.shields.io/badge/åšå®¢ï¼š-https://java666.cn-red?style=for-the-badge">
	</a>
</div>

---



```
   ___     ____   _____           _         _      __ _      _             _
  / __|   |_  /  |_   _|   ___   | |__     (_)    / _` |  __| |   __ _    | |_    __ _
  \__ \    / /     | |    |___|  | '_ \    | |    \__, | / _` |  / _` |   |  _|  / _` |
  |___/   /___|   _|_|_   _____  |_.__/   _|_|_   |___/  \__,_|  \__,_|   _\__|  \__,_|
_|"""""|_|"""""|_|"""""|_|     |_|"""""|_|"""""|_|"""""|_|"""""|_|"""""|_|"""""|_|"""""|
"`-0-0-'"`-0-0-'"`-0-0-'"`-0-0-'"`-0-0-'"`-0-0-'"`-0-0-'"`-0-0-'"`-0-0-'"`-0-0-'"`-0-0-'
```
---

## é¡¹ç›®è¯´æ˜ğŸš©ï¼š
- ğŸˆ è¯¥é¡¹ç›®ä¸»è¦åˆ†ææ·±åœ³é€šåˆ·å¡æ•°æ®ï¼Œé€šè¿‡å¤§æ•°æ®æŠ€æœ¯è§’åº¦æ¥ç ”ç©¶æ·±åœ³åœ°é“å®¢è¿èƒ½åŠ›ï¼Œæ¢ç´¢æ·±åœ³åœ°é“ä¼˜åŒ–æœåŠ¡çš„æ–¹å‘ï¼›
- âœ¨ å¼ºè°ƒå­¦ä»¥è‡´ç”¨ï¼Œæœ¬é¡¹ç›®çš„åŸåˆ™æ˜¯å°½å¯èƒ½ä½¿ç”¨è¾ƒå¤šçš„å¸¸ç”¨æŠ€æœ¯æ¡†æ¶ï¼ŒåŠ æ·±å¯¹å„æŠ€æœ¯æ ˆçš„ç†è§£å’Œè¿ç”¨ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä½“éªŒå„æ¡†æ¶çš„å·®å¼‚å’Œä¼˜åŠ£ï¼Œä¸ºä»¥åçš„é¡¹ç›®å¼€å‘æŠ€æœ¯é€‰å‹åšåŸºç¡€ï¼›
- ğŸ‘‘ è§£å†³åŒä¸€ä¸ªé—®é¢˜ï¼Œå¯èƒ½æœ‰å¤šç§æŠ€æœ¯å®ç°ï¼Œå®é™…çš„ä¼ä¸šå¼€å‘åº”å½“éµå®ˆæœ€ä½³å®è·µåŸåˆ™ï¼›
- ğŸ‰ å­¦ä¹ è¿‡ç¨‹ä¼˜å…ˆé€‰æ‹©è¾ƒæ–°çš„è½¯ä»¶ç‰ˆæœ¬ï¼Œå› ä¸ºæ–°ç‰ˆè¸©å‘ä¸€å®šæ¯”è€ç‰ˆæ›´å¤šï¼Œå‘è¸©çš„å¤šäº†ï¼ŒæŠ€èƒ½ä¹Ÿå°±æé«˜äº†ï¼Œé‡åˆ°æ–°é—®é¢˜å¯ä»¥è§æ‹›æ‹†æ‹›ã€å¯¹ç—‡ä¸‹è¯ï¼›
- ğŸš€ ...

---     
## ç¬¬ä¸€æœŸæ¶æ„å›¾
åŸå›¾ [.file/.doc/SZT-bigdata-2.png](.file/.doc/SZT-bigdata-2.png)  

![](.file/.doc/SZT-bigdata-2+.png)

```
æ•°å­—æ ‡è®°ä¸åˆ†å…ˆåé¡ºåºï¼Œå¯¹åº”ä»£ç ï¼š
1-cn.java666.sztcommon.util.SZTData
2-cn.java666.etlflink.app.Jsons2Redis
3-cn.java666.etlspringboot.controller.RedisController#get
4-cn.java666.etlflink.app.Redis2ES
5-cn.java666.etlflink.app.Redis2Csv
6-Hive sql è„šæœ¬ï¼ˆå¼€å‘ç»´æŠ¤æˆæœ¬æœ€ä½ï¼‰
7-Saprk ç¨‹åºï¼ˆå¼€å‘ç»´æŠ¤æˆæœ¬æœ€é«˜ï¼Œä½†æ˜¯åŠŸèƒ½æ›´å¼ºï¼‰
8-HUE æ–¹ä¾¿æŸ¥è¯¢å’Œå±•ç¤º Hive æ•°æ®
9-cn.java666.etlflink.app.Redis2HBase
10ã€14-cn.java666.szthbase.controller.KafkaListen#sink2Hbase
11-cn.java666.etlflink.app.Redis2HBase
12-CDH HDFS+HUE+Hbase+Hive ä¸€ç«™å¼æŸ¥è¯¢
13-cn.java666.etlflink.app.Redis2Kafka
15-cn.java666.sztflink.realtime.Kafka2MyCH
16-cn.java666.sztflink.realtime.sink.MyClickhouseSinkFun

```

**ä¸‹ä¸€æ­¥ï¼Œè®¡åˆ’å¼€å‘æ•°æ®æ¹–ä¸­å°è§£å†³æ–¹æ¡ˆ**

---

## æ ¸å¿ƒæŠ€æœ¯æ ˆ + ç‰ˆæœ¬é€‰æ‹© + ç‚¹è¯„ (æŒç»­æ›´æ–°)âš¡ï¼š
![](.file/.doc/stack2.jpg)  

- Java-1.8/Scala-2.11ï¼Œç”Ÿæ€ä¸°å¯Œï¼Œè½®å­å¤Ÿå¤šï¼›   
- Flink-1.10ï¼Œæµå¼ä¸šåŠ¡ã€ETL é¦–é€‰ã€‚å‘å±•åŠ¿å¤´å¦‚æ—¥ä¸­å¤©ï¼Œé˜¿é‡Œå·´å·´èƒŒä¹¦ï¼Œè½»å¿«çµæ´»ã€å¥æ­¥å¦‚é£ï¼›å°±é—®ä½ ä¿¡ä¸ä¿¡é©¬äº‘ï¼Ÿï¼Ÿï¼ŸğŸ˜šğŸ˜šğŸ˜š  
- Redis-3.2ï¼Œå¤©ç„¶å»é‡ï¼Œè‡ªåŠ¨æ’åºï¼Œé™¤äº†å¿«è¿˜æ˜¯å¿«ã€‚å»‰ä»·ç‰ˆç¡¬ç›˜å®ç°åŒç±»äº§å“ SSDBã€‚Win10|CentOS7|Docker Redis-3.2 ä¸‰é€‰ä¸€ï¼ŒCentOS REPL yum å®‰è£…é»˜è®¤ä½¿ç”¨3.2ç‰ˆæœ¬ï¼›  
- Kafka-2.1ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¸šåŠ¡è§£è€¦ã€æµé‡æ¶ˆå³°ã€è®¢é˜…å‘å¸ƒåœºæ™¯é¦–é€‰ã€‚æœ€ä½³ CPï¼škafka-eagle-1.4.5ï¼Œé›†ç”Ÿäº§ã€æ¶ˆè´¹ã€Ksqlã€å¤§å±ã€ç›‘æ§ã€æŠ¥è­¦äºä¸€èº«ï¼ŒåŒæ—¶ç›‘æ§ zkã€‚å…¶ä»–æˆ‘ç”¨è¿‡çš„ Kafka ç›‘æ§ç»„ä»¶æœ€åéƒ½æ”¾å¼ƒäº†ï¼š  
	- KafkaOffsetMonitor é—®é¢˜å¤ªå¤šï¼Œä¸‘æ‹’ï¼›  
	- Kafka Managerï¼Œå·²æ›´åä¸º CMAKï¼Œè€å¤–å†™çš„è½¯ä»¶ç”¨èµ·æ¥å°±è§‰å¾—å¾ˆåˆ«æ‰­ï¼Œè€Œä¸”æœ€é«˜åªå…¼å®¹ Kafka 0.11ï¼Œä½†æ˜¯ Kafka å®˜æ–¹å·²ç»å‡çº§åˆ° 2.4 äº†å•Šå–‚ï¼›  
	- å…¶ä»–å„ç§å¼€æºçš„ Kafka ç›‘æ§åŸºæœ¬éƒ½è¯•è¿‡ï¼Œä¸€ä¸ªèƒ½æ‰“çš„éƒ½æ²¡æœ‰ã€‚
- Zookeeper-3.4.5ï¼Œé›†ç¾¤åŸºç¡€ä¾èµ–ï¼Œé€‰ä¸¾æ—¶ ID è¶Šå¤§è¶Šä¼˜åŠ¿ï¼Œé€šè¿‡ä¼šè¯æœºåˆ¶ç»´æŠ¤å„ç»„ä»¶åœ¨çº¿çŠ¶æ€ï¼›  
- CDH-6.2ï¼Œè§£å†³äº†ç¨‹åºå‘˜æœ€éš¾æçš„è½¯ä»¶å…¼å®¹æ€§é—®é¢˜ï¼Œå…¨å®¶æ¡¶æœåŠ¡ä¸€é”®å®‰è£…ï¼›  
- Docker-19ï¼Œæœ€å¿«é€Ÿåº¦éƒ¨ç½²ä¸€æ¬¾æ–°è½¯ä»¶ï¼Œæ— ä¾µå…¥ã€æ— æ±¡æŸ“ã€å¿«é€Ÿæ‰©å®¹ã€æœåŠ¡æ‰“åŒ…ã€‚å¦‚æœå½“å‰æ²¡æœ‰åˆé€‚çš„è¿è¡Œç¯å¢ƒï¼Œé‚£ä¹ˆ docker ä¸€å®šæ˜¯é¦–é€‰ï¼›  
- SpringBoot-2.13ï¼Œé€šç”¨ JAVA ç”Ÿæ€ï¼Œæ•æ·å¼€å‘å¿…å¤‡ï¼›  
- knife4j-2.0ï¼Œå‰èº«ä¸º swagger-bootstrap-uiï¼ŒREST API é¡¹ç›®è°ƒè¯•ç®€ç›´ä¸è¦å¤ªæ–¹ä¾¿ï¼Œç§’æ€åŸç‰ˆä¸è¢œå“¥åä¸ªæ•°é‡çº§ï¼›  
- Elasticsearch-7ï¼Œå…¨æ–‡æ£€ç´¢é¢†åŸŸå”¯ä¸€é è°±çš„æ•°æ®åº“ï¼Œæœç´¢å¼•æ“æ ¸å¿ƒæœåŠ¡ï¼Œäº¿çº§æ•°æ®æ¯«ç§’å“åº”ï¼ŒçœŸå®æ—¶ï¼Œå‘ä¹Ÿå¤šğŸ”ŠğŸ”ŠğŸ”Šï¼›  
- Kibana-7.4ï¼ŒELK å…¨å®¶æ¡¶æˆå‘˜ï¼Œå‰ç«¯å¯è§†åŒ–ï¼Œå°ç™½ä¹Ÿä¸æ€•ï¼›  
- ClickHouseï¼Œå®¶å–»æˆ·æ™“çš„ nginx æœåŠ¡å™¨å°±æ˜¯ä¿„ç½—æ–¯çš„ä»£è¡¨ä½œï¼Œæ¥ä¸‹æ¥å¤§çº¢å¤§ç´«çš„ clickhouse åŒæ ·èº«è½»å¦‚ç‡•ï¼Œä½†æ˜¯æ€§èƒ½è¿œè¶…ç›®å‰å¸‚é¢æ‰€æœ‰åŒç±»æ•°æ®åº“ï¼Œå­˜å‚¨å®¹é‡å¯è¾¾PBçº§åˆ«ã€‚ç›®å‰èµ„æ–™è¿˜ä¸å¤šï¼Œæ­£åœ¨å­¦ä¹ ä¸­ï¼›  
- MongoDB-4.0ï¼Œæ–‡æ¡£æ•°æ®åº“ï¼Œå¯¹ Json æ•°æ®æ¯”è¾ƒå‹å¥½ï¼Œä¸»è¦ç”¨äºçˆ¬è™«æ•°æ®åº“ï¼›  
- Spark-2.3ï¼Œç›®å‰å›½å†…å¤§æ•°æ®æ¡†æ¶å®æ—¶å¾®æ‰¹å¤„ç†ã€ç¦»çº¿æ‰¹å¤„ç†ä¸»æµæ–¹æ¡ˆã€‚è¿™ä¸ªç»„ä»¶å¤ªåƒèµ„æºäº†ï¼Œæ›¾ç»åœ¨æˆ‘å¼€å‘æ—¶ï¼ŒæŠŠæˆ‘çš„ç¬”è®°æœ¬æåˆ°è“å±ï¼Œäºæ˜¯æˆ‘ç›´æ¥è¿œç¨‹æäº¤åˆ° spark é›†ç¾¤äº†ã€‚æ¥ä¸‹æ¥é¢„è®¡ Flink å¼€å§‹è¡¨æ¼”äº†ğŸ¦˜ï¼ŒçœŸçš„ç”¨äº†æ›´å¿«çš„æ¡†æ¶å°±çˆ±ä¸Šäº†ğŸ˜ğŸ˜ğŸ˜ï¼›  
- Hive-2.1ï¼ŒHadoop ç”Ÿæ€æ•°ä»“å¿…å¤‡ï¼Œå¤§æ•°æ®ç¦»çº¿å¤„ç† OLAP ç»“æ„åŒ–æ•°æ®åº“ï¼Œå‡†ç¡®æ¥è¯´æ˜¯ä¸ª HQL è§£æå™¨ï¼ŒæŸ¥è¯¢è¯­æ³•æ¥è¿‘ Mysqlï¼Œå°±æ˜¯çª—å£å‡½æ•°æ¯”è¾ƒå¤æ‚ğŸ˜­ğŸ˜­ğŸ˜­ï¼›  
- Impala-3.2ï¼Œåƒç¾šç¾Šä¸€æ ·è½»å¿«çŸ«å¥ï¼ŒåŒæ ·çš„ hive sql å¤æ‚æŸ¥è¯¢ï¼Œimpala æ¯«ç§’çº§è¿”å›ï¼Œhive å´éœ€è¦80ç§’å·¦å³ç”šè‡³æ›´å¤šï¼›  
- HBase-2.1 + Phoenixï¼ŒHadoop ç”Ÿæ€ä¸‹çš„éç»“æ„åŒ–æ•°æ®åº“ï¼ŒHBase çš„çµé­‚è®¾è®¡å°±æ˜¯ rowkey å’Œå¤šç‰ˆæœ¬æ§åˆ¶ï¼Œå‡¤å‡°å«æ¥ hbase å¯ä»¥å®ç°æ›´å¤æ‚çš„ä¸šåŠ¡ï¼›  
- Kylin-2.5ï¼Œéº’éºŸå¤šç»´é¢„åˆ†æç³»ç»Ÿï¼Œä¾èµ–å†…å­˜å¿«é€Ÿè®¡ç®—ï¼Œä½†æ˜¯å±€é™æ€§æœ‰ç‚¹å¤šå•Šï¼Œé€‚ç”¨äºä¸šåŠ¡ç‰¹åˆ«ç¨³å®šï¼Œçº¬åº¦å›ºå®šå°‘å˜çš„åœºæ™¯ï¼Œæ¸£æ¸£æœºå™¨å°±åˆ«è¯•äº†ï¼Œå†…å­˜å¤ªå°å¸¦ä¸èµ·ï¼›  
- HUE-4.3ï¼ŒCDH å…¨å®¶æ¡¶èµ é€çš„ï¼Œå¼ºè°ƒç”¨æˆ·ä½“éªŒï¼Œæ“ä½œæ•°ä»“å¾ˆæ–¹ä¾¿ï¼Œæƒé™æ§åˆ¶ã€hive + impala æŸ¥è¯¢ã€hdfs æ–‡ä»¶ç®¡ç†ã€oozie ä»»åŠ¡è°ƒåº¦è„šæœ¬ç¼–å†™å…¨é ä»–äº†ï¼›  
- é˜¿é‡Œå·´å·´ DataXï¼Œå¼‚æ„æ•°æ®æºåŒæ­¥å·¥å…·ï¼Œä¸»æŒå¤§éƒ¨åˆ†ä¸»æµæ•°æ®åº“ï¼Œç”šè‡³å¯ä»¥è‡ªå·±å¼€å‘æ’ä»¶ï¼Œé©¬äº‘å®¶çš„ä¸œè¥¿ï¼Œæˆ‘é€‰ä½ ï¼ï¼ï¼å¦‚æœä½ è§‰å¾—è¿™è¿˜æ»¡è¶³ä¸äº†ä½ çš„ç‰¹æ®Šä¸šåŠ¡éœ€æ±‚ï¼Œé‚£ä¹ˆæ¨èä½ ç”¨ FlinkXï¼ŒåŸºäº Flink çš„åˆ†å¸ƒå¼æ•°æ®åŒæ­¥å·¥å…·ã€‚ç†è®ºä¸Šä½ ä¹Ÿå¯ä»¥è‡ªå·±å¼€å‘æ’ä»¶ï¼›   
- Oozie-5.1ï¼Œæœ¬èº« UI å¥‡ä¸‘ï¼Œä½†æ˜¯é…åˆ HUE é£Ÿç”¨å°šå¯æ¥å—ï¼Œä¸»è¦ç”¨æ¥ç¼–å†™å’Œè¿è¡Œä»»åŠ¡è°ƒåº¦è„šæœ¬ï¼›  
- Sqoop-1.4ï¼Œä¸»è¦ç”¨æ¥ä» Mysql å¯¼å‡ºä¸šåŠ¡æ•°æ®åˆ° HDFS æ•°ä»“ï¼Œåè¿‡æ¥ä¹Ÿè¡Œï¼›  
- Mysql-5.7ï¼Œç¨‹åºå‘˜éƒ½è¦ç”¨çš„å§ï¼Œå¦‚æœè¯´å…¨ä¸–ç•Œç¨‹åºå‘˜éƒ½ä¼šç”¨çš„è¯­è¨€ï¼Œé‚£ä¸€å®šæ˜¯ SQLã€‚Mysql 8.0 æ™®åŠç‡ä¸å¤Ÿé«˜ï¼ŒMariaDB æš‚ä¸æ¨èï¼Œå¤æ‚çš„å‡½æ•°ä¸å…¼å®¹ Mysqlï¼Œæ•°æ®åº“è¿™ä¹ˆåŸºç¡€çš„ä¾èµ–ç»„ä»¶å‡ºäº†é—®é¢˜ä½ å°±å“­å§ï¼›   
- Hadoop3.0ï¼ˆHDFS+Yarnï¼‰ï¼ŒHDFS æ˜¯ç›®å‰å¤§æ•°æ®é¢†åŸŸæœ€ä¸»æµçš„åˆ†å¸ƒå¼æµ·é‡æ•°æ®å­˜å‚¨ç³»ç»Ÿï¼Œè¿™é‡Œçš„ Yarn ç‰¹æŒ‡ hadoop ç”Ÿæ€ï¼Œä¸»è¦ç”¨æ¥åˆ†é…é›†ç¾¤èµ„æºï¼Œè‡ªå¸¦æ‰§è¡Œå¼•æ“ MRï¼›  
- é˜¿é‡Œå·´å·´ DataV å¯è§†åŒ–å±•ç¤ºï¼›   
- ...  

> æˆ‘å‘ç°è¶Šæ¥è¶Šå¤šçš„å›½äº§å¼€æºè½¯ä»¶ç”¨æˆ·ä½“éªŒå€¼å¾—è‚¯å®šã€‚ã€‚ã€‚

---

## å‡†å¤‡å·¥ä½œğŸ¬ï¼š
ä»¥ä¸‹æ˜¯æˆ‘çš„å¼€å‘ç¯å¢ƒï¼Œä»…ä½œå‚è€ƒï¼š

- Win10 IDEA 2019.3 æ——èˆ°ç‰ˆï¼ŒJAVA|Scala å¼€å‘å¿…å¤‡ï¼Œé›†ä¸‡èˆ¬åŠŸèƒ½äºä¸€èº«ï¼›
- Win10 DBeaver ä¼ä¸šç‰ˆ 6.3ï¼Œç§’æ€å…¨å®‡å®™æ‰€æœ‰æ•°æ®åº“å®¢æˆ·ç«¯ï¼Œå‡ ä¹ä¸€åˆ‡å¸¸ç”¨æ•°æ®åº“éƒ½å¯ä»¥è¿ï¼Œé€‰å¥½é©±åŠ¨æ˜¯å…³é”®ï¼›
- Win10 Sublime Text3ï¼Œåœ°è¡¨æœ€å¼ºè½»é‡çº§ç¼–è¾‘å™¨ï¼Œå…‰é€Ÿå¯åŠ¨ï¼Œæ— é™é‡æ’ä»¶ï¼Œä¸»è¦ç”¨æ¥ç¼–è¾‘é›¶æ•£æ–‡ä»¶ã€markdown å®æ—¶é¢„è§ˆã€å†™å‰ç«¯ç‰¹åˆ«å‹å¥½ï¼ˆè™½ç„¶æˆ‘ä¸æ“…é•¿ğŸ–ğŸ–ğŸ–ï¼‰ï¼Œé€Ÿåº¦å¿«åˆ°å®Œå…¨ä¸ç”¨æ‹…å¿ƒè½¯ä»¶è·Ÿä¸ä¸Šä½ çš„æ‰‹é€Ÿï¼›
- å…¶ä»–ä¸€äº›å®ç”¨å·¥å…·å‚è€ƒæˆ‘çš„åšå®¢ï¼š<a href="https://java666.cn/#/AboutMe" target="_blank">https://java666.cn/#/AboutMe</a>
- CentOS7 CDH-6.2 é›†ç¾¤ï¼ŒåŒ…å«å¦‚ä¸‹ç»„ä»¶ï¼Œå¯¹åº”çš„ä¸»æœºè§’è‰²å’Œé…ç½®å¦‚å›¾ï¼Œé›†ç¾¤è‡³å°‘éœ€è¦40 GB æ€»å†…å­˜ï¼Œæ‰å¯ä»¥æ»¡è¶³åŸºæœ¬ä½¿ç”¨ï¼Œä¸å·®é’±çš„å‰æä¸‹ï¼ŒRAM å½“ç„¶æ˜¯åˆç†èŒƒå›´å†…è¶Šå¤§è¶Šå¥½å•¦ï¼Œé²è¿…éƒ½è¯´â€œå¤©ä¸‹æ­¦åŠŸå”¯å¿«ä¸ç ´â€ï¼›æˆ‘ä»¬çš„è¿½æ±‚æ˜¯è¶Šå¿«è¶Šå¥½ï¼›  

![](.file/.pic/0-cdh-view.png)   

![](.file/.pic/0-cdh-host.png)   

![](.file/.pic/0-cdh-role.png)   

å¦‚æœä½ é€‰ç”¨åŸç‰ˆ Apache ç»„ä»¶æ­å»ºå¤§æ•°æ®é›†ç¾¤ï¼Œé‚£ä¹ˆä½ ä¼šæœ‰è¸©ä¸å®Œçš„å‘ã€‚æˆ‘çš„å¤´å‘ä¸å¤Ÿæ‰äº†ï¼Œæ‰€ä»¥æˆ‘é€‰ CDHï¼ï¼ï¼âš™ğŸ› ğŸ˜ğŸ˜ğŸ˜

## ç‰©ç†æœºé…ç½®ğŸ’ï¼š

- ä»¥ä¸Šè½¯ä»¶åˆ†å¼€éƒ¨ç½²åœ¨æˆ‘çš„ä¸‰å°ç”µè„‘ä¸Šï¼ŒWin10 ç¬”è®°æœ¬ VMware + Win10 å°å¼æœº VMware + å¤è‘£ç¬”è®°æœ¬ CentOS7ã€‚ç‰©ç†æœºå…¨éƒ½é…ç½® SSD + åƒå…†ä»¥å¤ªç½‘å¡ï¼ŒHDFS éœ€è¦æœ€å¿«çš„ç½‘å¡ã€‚å¥½é©¬é…å¥½éï¼Œå½“ç„¶ä½ å¾—æœ‰ä¸ªåƒå…†äº¤æ¢æœºé…åˆåƒå…†ç½‘çº¿ï¼Œæœ¨æ¡¶åŸç†è­¦å‘Šï¼ï¼ï¼ğŸˆğŸˆğŸˆ

- æœ‰ä¸ªæœºæ¶å½“ç„¶å†å¥½ä¸è¿‡äº†ï¼Œå“ˆå“ˆå“ˆã€‚ã€‚ã€‚
![](.file/.pic/0-pcs.jpg)   

- å¦‚æœä½ æƒ³é¿å…ç½‘çº¿ç‰µæ¥ç‰µå»ï¼Œå¯ä»¥é‡‡ç”¨ç”µåŠ›çŒ«å®ç°åˆ†å¸ƒå¼å®¶åº­ç»„ç½‘æ–¹æ¡ˆï¼›

---

## æ•°æ®æºğŸŒï¼š
- æ·±åœ³å¸‚æ”¿åºœæ•°æ®å¼€æ”¾å¹³å°ï¼Œæ·±åœ³é€šåˆ·å¡æ•°æ® 133.7 ä¸‡æ¡ã€ç¦»çº¿æ•°æ®ã€‘ï¼Œ
https://opendata.sz.gov.cn/data/api/toApiDetails/29200_00403601
	
ç†è®ºä¸Šå¯ä»¥å½“ä½œå®æ—¶æ•°æ®ï¼Œä½†æ˜¯è¿™ä¸ªæ¥å£å“åº”å¤ªæ…¢äº†ï¼Œå¦‚æœé‡‡ç”¨ kafka é˜Ÿåˆ—æ–¹å¼ï¼Œä¹Ÿå¯ä»¥æ¨¡æ‹Ÿå‡ºå®æ—¶æ•ˆæœã€‚ 

æœ¬é¡¹ç›®é‡‡ç”¨ç¦»çº¿ + å®æ—¶æ€è·¯ å¤šç§æ–¹æ¡ˆå¤„ç†ã€‚

---

## å¼€å‘è¿›åº¦ğŸ¥‡ï¼š
> å‡†å¤‡å¥½ javaã€scalaã€å¤§æ•°æ®å¼€å‘å¸¸ç”¨çš„ç¯å¢ƒï¼Œæ¯”å¦‚ IDEAã€VMware è™šæ‹Ÿæœºã€CDHç­‰ï¼Œç„¶åæ‰‹æœºé™éŸ³ç›–ä¸Šï¼Œè·Ÿæˆ‘ä¸€èµ·å·¦æ‰‹ç”»ä¸ªé¾™ï¼Œå³æ‰‹åˆ’ä¸€é“å½©è™¹ï¼Œå¼€å§‹è¡¨æ¼”å§ğŸ¤ª

---

### 1- è·å–æ•°æ®æºçš„ appKeyï¼š
    https://opendata.sz.gov.cn/data/api/toApiDetails/29200_00403601

---

### 2- ä»£ç å¼€å‘ï¼š

#### 2.1- è°ƒç”¨ `cn.java666.etlspringboot.source.SZTData#saveData` è·å–åŸå§‹æ•°æ®å­˜ç›˜ `/tmp/szt-data/szt-data-page.jsons`ï¼Œæ ¸å¯¹æ•°æ®é‡ 1337ï¼Œæ³¨æ„è¿™é‡Œæ¯æ¡æ•°æ®åŒ…å«1000æ¡å­æ•°æ®ï¼›

---

#### 2.2- è°ƒç”¨ `cn.java666.etlflink.sink.RedisSinkPageJson#main` å®ç° etl æ¸…æ´—ï¼Œå»é™¤é‡å¤æ•°æ®ï¼Œredis å¤©ç„¶å»é‡æ’åºï¼Œä¿è¯æ•°æ®å¹²å‡€æœ‰åºï¼Œè·‘å®Œåæ ¸å¯¹ redis æ•°æ®é‡ 1337ã€‚

---

#### 2.3- redis æŸ¥è¯¢ï¼Œredis-cli ç™»å½•åæ‰§è¡Œ ` hget szt:pageJson 1 `   
æˆ–è€… dbeaver å¯è§†åŒ–æŸ¥è¯¢ï¼š  
![](.file/.pic/redis-szt-pageJson.png)  

---

#### 2.4- `cn.java666.etlspringboot.EtlSApp#main` å¯åŠ¨åï¼Œä¹Ÿå¯ä»¥ç”¨ knife4j åœ¨çº¿è°ƒè¯• REST APIï¼š  
![](.file/.pic/api-1.png)   

![](.file/.pic/api-debug.png)   

---

#### 2.5- `cn.java666.etlflink.source.MyRedisSourceFun#run` æ¸…æ´—æ•°æ®å‘ç° 133.7 ä¸‡æ•°æ®ä¸­ï¼Œæœ‰å°éƒ¨åˆ†æºæ•°æ®å­—æ®µæ•°ä¸º9ï¼Œç¼ºå°‘ä¸¤ä¸ªå­—æ®µï¼šstationã€car_noï¼›ä¸¢å¼ƒè„æ•°æ®ã€‚

åˆæ ¼æºæ•°æ®ç¤ºä¾‹ï¼š
```json
{
	"deal_date": "2018-08-31 21:15:55",
	"close_date": "2018-09-01 00:00:00",
	"card_no": "CBHGDEEJB",
	"deal_value": "0",
	"deal_type": "åœ°é“å…¥ç«™",
	"company_name": "åœ°é“äº”å·çº¿",
	"car_no": "IGT-104",
	"station": "å¸ƒå‰",
	"conn_mark": "0",
	"deal_money": "0",
	"equ_no": "263032104"
}
```
ä¸åˆæ ¼çš„æºæ•°æ®ç¤ºä¾‹ï¼š
```json
{
	"deal_date": "2018-09-01 05:24:22",
	"close_date": "2018-09-01 00:00:00",
	"card_no": "HHAAABGEH",
	"deal_value": "0",
	"deal_type": "åœ°é“å…¥ç«™",
	"company_name": "åœ°é“ä¸€å·çº¿",
	"conn_mark": "0",
	"deal_money": "0",
	"equ_no": "268005140"
}
```

---

#### 2.6- `cn.java666.etlflink.app.Redis2Kafka#main` æ ¹æ®éœ€æ±‚æ¨é€æ»¡è¶³ä¸šåŠ¡è¦æ±‚çš„æºæ•°æ®åˆ° kafkaï¼Œ`topic-flink-szt-all` ä¿ç•™äº†æ‰€æœ‰æºæ•°æ® 1337000 æ¡ï¼Œ `topic-flink-szt` ä»…åŒ…å«æ¸…æ´—åˆæ ¼çš„æºæ•°æ® 1266039 æ¡ã€‚

---

#### 2.7- kafka-eagle ç›‘æ§æŸ¥çœ‹ topicï¼ŒåŸºäºåŸç‰ˆå»æ‰äº†èƒŒæ™¯å›¾ï¼Œæ¼‚äº®å¤šäº†ï¼š  
![](.file/.pic/kafka-eagle02.png)  

![](.file/.pic/kafka-eagle01.png)  

ksql å‘½ä»¤æŸ¥è¯¢ï¼š `select * from "topic-flink-szt" where "partition" in (0) limit 1000`  

![](.file/.pic/ksql.png)  

---

#### 2.8- `cn.java666.etlflink.app.Redis2Csv#main` å®ç°äº† flink sink csv æ ¼å¼æ–‡ä»¶ï¼Œå¹¶ä¸”æ”¯æŒæŒ‰å¤©åˆ†å—ä¿å­˜ã€‚  
![](.file/.pic/csv.png)

---

#### 2.9- `cn.java666.etlflink.app.Redis2ES#main`  å®ç°äº† ES å­˜å‚¨æºæ•°æ®ã€‚å®ç°å®æ—¶å…¨æ–‡æ£€ç´¢ï¼Œå®æ—¶è·Ÿè¸ªæ·±åœ³é€šåˆ·å¡æ•°æ®ã€‚  

è¿™ä¸ªæ¨¡å—æ¶‰åŠæŠ€æœ¯ç»†èŠ‚æ¯”è¾ƒå¤šï¼Œå¦‚æœæ²¡æœ‰ ES ä½¿ç”¨ç»éªŒï¼Œå¯ä»¥å…ˆåšä¸‹åŠŸè¯¾ï¼Œä¸ç„¶çš„è¯ä¼šå¾ˆæ‡µã€‚  

æˆ‘ä¹‹å‰åœ¨å¤„ç† ES å„ç§é—®é¢˜è¸©äº†ä¸å°‘å‘ï¼Œç†¬äº†ä¸å°‘é€šå®µï¼Œæ‰äº†å¾ˆå¤šå¤´å‘ã€‚    

**é‡åˆ°é—®é¢˜å¿ƒæ€è¦ç¨³ï¼Œå› ä¸ºä½ ä»Šå¤©å¤„ç†äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ˜å¤©æ¥è§¦æ–°çš„ç‰ˆæœ¬æ–°çš„æ¡†æ¶å¤§æ¦‚ç‡åˆä¼šå‡ºç°æ–°çš„é—®é¢˜**ã€‚ã€‚ğŸ¥ºğŸ¥ºğŸ¥º   

æ‰€ä»¥æœ€ä½³å®è·µå¾ˆé‡è¦ï¼ï¼ï¼  

> **ğŸ‘‡ğŸ‘‡ğŸ‘‡è¿™éƒ¨åˆ†å†…å®¹æœ‰æ›´æ–°ï¼šä¿®æ­£äº†ä¸Šä¸€ä¸ªç‰ˆæœ¬æ—¶åŒºé—®é¢˜ã€‚**  

ğŸ¬æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬æ—¶å…‰å€’æµï¼Œå›åˆ° 2018-09-01è¿™ä¸€å¤©ï¼Œè°ƒæ•´ kibana é¢æ¿æ—¶é—´èŒƒå›´ `2018-09-01 00:00:00.000~2018-09-01 23:59:59.999`ï¼Œçœ‹çœ‹å½“å¤©æ·±åœ³é€šåˆ·å¡è®°å½•çš„ç»Ÿè®¡å›¾æ›²çº¿èµ°å‘æ˜¯å¦ç§‘å­¦ï¼Œé—´æ¥éªŒè¯æ•°æ®æºçš„å®Œæ•´æ€§ã€‚ 

ä¿®æ­£æ—¶åŒºåç»Ÿè®¡æ•°é‡ï¼Œå­—æ®µå®Œæ•´çš„åˆæ ¼æºæ•°æ® 1266039 æ¡ï¼Œ2018-09-01å…¨å¤© 1229180 æ¡ã€‚  
![](.file/.pic/2018-09-01.png)  

å›¾ä¸­å¯ä»¥çœ‹å‡º 2018-09-01 è¿™ä¸€å¤©åˆ·å¡è®°å½•é›†ä¸­åœ¨ä¸Šåˆ6ç‚¹~12ç‚¹ä¹‹é—´ï¼Œæ—©é«˜å³°æ•°æ®æ¯”è¾ƒå»åˆï¼Œè™½ç„¶è¿™ä¸€å¤©æ˜¯å‘¨å…­ï¼Œé«˜å³°æœŸä¸æ˜¯ç‰¹åˆ«æ˜æ˜¾ã€‚æˆ‘ä»¬ç»§ç»­ç¼©æ”¾ kibana æ—¶é—´è½´çœ‹çœ‹æ›´è¯¦ç»†çš„æ›²çº¿ï¼š
![](.file/.pic/2018-09-01-am.png)  

å›é¡¾ä¸€ä¸‹æœ¬é¡¹ç›® ETL å¤„ç†æµç¨‹ï¼š
> 1337000 æ¡æºæ•°æ®æ¸…æ´—å»é™¤å­—æ®µä¸å…¨çš„è„æ•°æ®ï¼Œå‰©ä½™çš„åˆæ ¼æ•°æ®æ¡æ•° 1266039 å·²ç»è¿›å…¥ ES ç´¢å¼• `szt-data`  

> åœ¨ 1266039 æ¡åˆæ ¼æ•°æ®ä¸­ï¼Œæœ‰ 1227234 æ¡æ•°æ®é›†ä¸­åœ¨ 2018-09-01 è¿™ä¸€å¤©çš„ä¸Šåˆæ—¶æ®µï¼›  

> æˆ‘ä»¬æš‚ä¸”ç›¸ä¿¡ä¸Šåˆæ—¶æ®µçš„æ•°æ®æ˜¯çœŸå®çš„ï¼Œé‚£ä¹ˆæ˜¯å¦è¯´æ˜å®˜æ–¹æä¾›çš„æ•°æ®å¹¶ä¸æ˜¯å…¨éƒ¨çš„å½“å¤©å®Œæ•´åˆ·å¡æ•°æ®ï¼Ÿï¼Ÿï¼Ÿ 

> å¦‚æœæŒ‰ç…§ä¸Šåˆçš„åˆ·å¡é‡æ¥ä¼°æµ‹å…¨å¤©çš„åˆ·å¡é‡ï¼Œè€ƒè™‘åˆ°æ˜¯å‘¨å…­ï¼Œé‚£ä¹ˆæ·±åœ³é€šå…¨å¤©çš„åˆ·å¡è®°å½•æ•°æ®åº”è¯¥åœ¨ 122ä¸‡ X 2 å·¦å³ï¼Œå½“ç„¶è¿™ä¹ˆæ­¦æ–­çš„åˆ¤æ–­æ–¹å¼ä¸æ˜¯ç¨‹åºå‘˜çš„é£æ ¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ç§‘å­¦çš„å¤§æ•°æ®åˆ†ææ–¹å¼æ¥ç ”ç©¶è¿™äº›æ•°æ®èƒŒåçš„æ„ä¹‰ã€‚

æ³¨æ„ï¼ŒES å¤§å‘ï¼š  
- ES å­˜æ•°æ®æ—¶ï¼Œå¸¦æœ‰æ—¶é—´å­—æ®µçš„æ•°æ®å¦‚ä½•å®æ—¶å±•ç¤ºåˆ° kibana çš„å›¾è¡¨é¢æ¿ä¸Šï¼Ÿ  
ğŸ¤£éœ€è¦åœ¨å­˜å…¥ index ä¹‹å‰è®¾ç½®å­—æ®µæ˜ å°„ã€‚å‚è€ƒæ ¼å¼ï¼Œä¸è¦ç…§æŠ„ï¼ï¼ï¼
```json
{
  "properties": {
	"deal_date": {
	  "format": "yyyy-MM-dd HH:mm:ss",
	  "type": "date"
	}
  }
}  
```
è¿™é‡Œå¹¶æ²¡æœ‰æŒ‡å®šæ—¶åŒºä¿¡æ¯ï¼Œä½†æ˜¯ ES é»˜è®¤ä½¿ç”¨ 0 æ—¶åŒºï¼Œè¿™ä¸ªè½¯ä»¶å¾ˆå‘ï¼Œæ— æ³•è®¾ç½®å…¨å±€é»˜è®¤æ—¶åŒºã€‚ä½†æ˜¯å¾ˆå¤šè½¯ä»¶äº§ç”Ÿçš„æ•°æ®éƒ½æ˜¯é»˜è®¤æœºå™¨æ‰€åœ¨æ—¶åŒºï¼Œå›½å†…å°±æ˜¯ä¸œå…«åŒºã€‚å› ä¸ºæˆ‘ä»¬çš„æºå§‹æ•°æ®æœ¬èº«ä¹Ÿæ²¡æœ‰åŒ…å«æ—¶åŒºä¿¡æ¯ï¼Œè¿™é‡Œæˆ‘ä¸æƒ³æ”¹æºæ•°æ®ï¼Œé‚£å°±å‡è£…è‡ªå·±åœ¨ ES çš„ 0 æ—¶åŒºã€‚åŒæ—¶éœ€è¦ä¿®æ”¹ kibana é»˜è®¤æ—¶åŒºä¸º UTCï¼Œæ‰å¯ä»¥ä¿è¯ kibana ç´¢å¼•å›¾è¡¨æ—¶é—´è½´æ­£ç¡®å¯¹ä½ã€‚ä¸è¿‡è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªç§‘å­¦çš„è§£å†³æ–¹æ¡ˆã€‚  

**å¦‚æœæ˜¯ä¼ä¸šé¡¹ç›®ï¼Œå¿…é¡»è¦ç”¨æ•°æ®è´¨é‡ç›‘æ§è½¯ä»¶ï¼ï¼ï¼è¦ä¸ç„¶å¾—æœ‰å¤šå°‘èƒŒé”…ä¾ è¦æ€å»ç¥­å¤©ğŸ˜‚ğŸ˜‚ğŸ˜‚ï¼Œæ•°æ®å¯ä»¥æ²¡æœ‰ä½†æ˜¯åƒä¸‡ä¸èƒ½é”™ã€‚**  

- ES å­˜æ•°æ®æ—¶ï¼Œéœ€è¦ä½¿ç”¨ json æ ¼å¼åŒ…è£…æ•°æ®ï¼Œä¸ç¬¦åˆjson è¯­æ³•çš„çº¯å­—ç¬¦æ— æ³•ä¿å­˜ï¼›  
- ES åºåˆ—åŒ–å¤æ‚çš„ bean å¯¹è±¡æ—¶ï¼Œå¦‚æœ fastjson æŠ¥é”™ï¼Œæ¨èä½¿ç”¨ Gsonï¼Œå¾ˆå¼ºï¼  

### TIPSğŸ˜™ğŸ˜™ğŸ˜™ï¼š
- Gson ç›¸æ¯” fastjsonï¼šGson åºåˆ—åŒ–èƒ½åŠ›æ›´å¼ºï¼Œä½†æ˜¯ ååºåˆ—åŒ–æ—¶ï¼Œfastjson é€Ÿåº¦æ›´å¿«ã€‚

---

#### 2.10- æŸ¥çœ‹ ES æ•°æ®åº“å¡å·ï¼Œå¯¹æ¯”è‡ªå·±çš„æ·±åœ³é€šåœ°é“å¡ï¼Œé€æ¸å‘ç°äº†ä¸€äº›è„±æ•è§„å¾‹ã€‚  
æ—¥å¿—å½“ä¸­å¡å·è„±æ•å­—æ®µå¯†æ–‡åè§£çŒœæƒ³ï¼š  
ç”±è„±æ•çš„å¯†æ–‡å¡å·åæ¨çœŸå®å¡å·ï¼Œå› ä¸ºæ‰€æœ‰å¡å·å¯†æ–‡å½“ä¸­æ²¡æœ‰Jå¼€å¤´çš„æ•°æ®ï¼Œ
ä½†æ˜¯æœ‰Aå¼€å¤´çš„æ•°æ®ï¼ŒA != 0ï¼Œè€Œä¸”å‡ºç°äº† BCDEFGHIJ æ²¡æœ‰ Kï¼Œæ‰€ä»¥çŒœæƒ³å¡å·æ˜ å°„å…³ç³»å¦‚å›¾ï¼ï¼ï¼   
![](.file/.pic/parse_card_no.png)  
ç±»ä¼¼æ‘©æ–¯ç”µç è§£å¯†ã€‚ã€‚ã€‚æˆ‘ç°åœ¨è¿˜ä¸ç¡®å®šè¿™ä¸ªè§£å¯†æ–¹å¼æ˜¯å¦æ­£ç¡®ğŸ™„ğŸ™„ğŸ™„  

---

#### 2.11- `cn.java666.sztcommon.util.ParseCardNo#parse` å®ç°äº†æ”¯æŒè‡ªåŠ¨è¯†åˆ«å¡å·æ˜æ–‡å’Œå¯†æ–‡ã€ä¸€é”®äº’è½¬åŠŸèƒ½ã€‚ `cn.java666.etlspringboot.controller.CardController#get` å®ç°äº†å¡å·æ˜æ–‡å’Œå¯†æ–‡äº’è½¬ REST APIã€‚    
![](.file/.pic/parse_no.png)  

---

### 3- æ­å»ºæ•°ä»“ï¼šæ·±åœ³åœ°é“æ•°ä»“å»ºæ¨¡  

#### 3.1- ç¬¬ä¸€æ­¥ï¼Œåˆ†æä¸šåŠ¡    
ç¡®å®šä¸šåŠ¡æµç¨‹ ---> å£°æ˜ç²’åº¦ ---> ç¡®å®šç»´åº¦ ---> ç¡®å®šäº‹å®

![](.file/.doc/dim.png)   
   
#### 3.2- ç¬¬äºŒæ­¥ï¼Œè§„åˆ’æ•°ä»“ç»“æ„  
å‚è€ƒè¡Œä¸šé€šç”¨çš„æ•°ä»“åˆ†å±‚æ¨¡å¼ï¼šODSã€DWDã€DWSã€ADSï¼Œè™½ç„¶åŸå§‹æ•°æ®å¾ˆç®€å•ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾ç„¶ä½¿ç”¨è§„èŒƒçš„æµç¨‹è®¾è®¡æ•°æ®ä»“åº“ã€‚   

- ç¬¬ä¸€å±‚ï¼šODS åŸå§‹æ•°æ®å±‚  
```
ods/ods_szt_data/day=2018-09-01/   
# szt_szt_page/day=2018-09-01/  
```

- ç¬¬äºŒå±‚ï¼šDWD æ¸…æ´—é™ç»´å±‚  
  åŒºåˆ†ç»´è¡¨ dim_ å’Œäº‹å®è¡¨ fact_ï¼Œä¸ºäº†ä½¿ç²’åº¦æ›´åŠ ç»†åŒ–ï¼Œæˆ‘ä»¬æŠŠè¿›ç«™å’Œå‡ºç«™è®°å½•åˆ†å¼€ï¼Œå·´å£«æ•°æ®æš‚ä¸è€ƒè™‘ã€‚ 
```
dwd_fact_szt_in_detail      è¿›ç«™äº‹å®è¯¦æƒ…è¡¨
dwd_fact_szt_out_detail     å‡ºç«™äº‹å®è¯¦æƒ…è¡¨
dwd_fact_szt_in_out_detail  åœ°é“è¿›å‡ºç«™æ€»è¡¨
```

- ç¬¬ä¸‰å±‚ï¼šDWS å®½è¡¨å±‚    
```
dws_card_record_day_wide  æ¯å¡æ¯æ—¥è¡Œç¨‹è®°å½•å®½è¡¨ã€å•å¡å•æ—¥æ‰€æœ‰å‡ºè¡Œè®°å½•ã€‘
```

- ç¬¬å››å±‚ï¼šADS ä¸šåŠ¡æŒ‡æ ‡å±‚ã€å¾…è¡¥å……ã€‘  
```
ã€ä½“ç°è¿›ç«™å‹åŠ›ã€‘ æ¯ç«™è¿›ç«™äººæ¬¡æ’è¡Œæ¦œ      
	ads_in_station_day_top
ã€ä½“ç°å‡ºç«™å‹åŠ›ã€‘ æ¯ç«™å‡ºç«™äººæ¬¡æ’è¡Œæ¦œ      
	ads_out_station_day_top
ã€ä½“ç°è¿›å‡ºç«™å‹åŠ›ã€‘ æ¯ç«™è¿›å‡ºç«™äººæ¬¡æ’è¡Œæ¦œ      
	ads_in_out_station_day_top
ã€ä½“ç°é€šå‹¤è½¦è´¹æœ€å¤šã€‘ æ¯å¡æ—¥æ¶ˆè´¹æ’è¡Œ      
	ads_card_deal_day_top  
ã€ä½“ç°çº¿è·¯è¿è¾“è´¡çŒ®åº¦ã€‘ æ¯çº¿è·¯å•æ—¥è¿è¾“ä¹˜å®¢æ€»æ¬¡æ•°æ’è¡Œæ¦œï¼Œè¿›ç«™ç®—ä¸€æ¬¡ï¼Œå‡ºç«™å¹¶ä¸”è”ç¨‹ç®—ä¸€æ¬¡     
	ads_line_send_passengers_day_top  
ã€ä½“ç°åˆ©ç”¨ç‡æœ€é«˜çš„è½¦ç«™åŒºé—´ã€‘ æ¯æ—¥è¿è¾“ä¹˜å®¢æœ€å¤šçš„è½¦ç«™åŒºé—´æ’è¡Œæ¦œ       
	ads_stations_send_passengers_day_top
ã€ä½“ç°çº¿è·¯çš„å¹³å‡é€šå‹¤æ—¶é—´ï¼Œè¿è¾“æ•ˆç‡ã€‘ æ¯æ¡çº¿è·¯å•ç¨‹ç›´è¾¾ä¹˜å®¢è€—æ—¶å¹³å‡å€¼æ’è¡Œæ¦œ     
	ads_line_single_ride_average_time_day_top
ã€ä½“ç°æ·±åœ³åœ°é“å…¨å¸‚ä¹˜å®¢å¹³å‡é€šå‹¤æ—¶é—´ã€‘ æ‰€æœ‰ä¹˜å®¢ä»ä¸Šè½¦åˆ°ä¸‹è½¦é—´éš”æ—¶é—´å¹³å‡å€¼    
	ads_all_passengers_single_ride_spend_time_average
ã€ä½“ç°é€šå‹¤æ—¶é—´æœ€é•¿çš„ä¹˜å®¢ã€‘ å•æ—¥ä»ä¸Šè½¦åˆ°ä¸‹è½¦é—´éš”æ—¶é—´æ’è¡Œæ¦œ     
	ads_passenger_spend_time_day_top
ã€ä½“ç°è½¦ç«™é…ç½®ã€‘ æ¯ä¸ªç«™ç‚¹è¿›å‡ºç«™é—¸æœºæ•°é‡æ’è¡Œæ¦œ
	æ¯ä¸ªç«™ç‚¹å…¥ç«™é—¸æœºæ•°é‡  		ads_station_in_equ_num_top
	æ¯ä¸ªç«™ç‚¹å‡ºç«™é—¸æœºæ•°é‡    		ads_station_out_equ_num_top
ã€ä½“ç°å„çº¿è·¯ç»¼åˆæœåŠ¡æ°´å¹³ã€‘ å„çº¿è·¯è¿›å‡ºç«™é—¸æœºæ•°æ’è¡Œæ¦œ
	å„çº¿è·¯è¿›ç«™é—¸æœºæ•°æ’è¡Œæ¦œ 		ads_line_in_equ_num_top.png
	å„çº¿è·¯å‡ºç«™é—¸æœºæ•°æ’è¡Œæ¦œ 		ads_line_out_equ_num_top
ã€ä½“ç°æ”¶å…¥æœ€å¤šçš„è½¦ç«™ã€‘ å‡ºç«™äº¤æ˜“æ”¶å…¥æ’è¡Œæ¦œ   
	ads_station_deal_day_top
ã€ä½“ç°æ”¶å…¥æœ€å¤šçš„çº¿è·¯ã€‘ å‡ºç«™äº¤æ˜“æ‰€åœ¨çº¿è·¯æ”¶å…¥æ’è¡Œæ¦œ   
	ads_line_deal_day_top
ã€ä½“ç°æ¢ä¹˜æ¯”ä¾‹ã€ä¹˜è½¦ä½“éªŒã€‘ æ¯å¤©æ¯çº¿è·¯æ¢ä¹˜å‡ºç«™ä¹˜å®¢ç™¾åˆ†æ¯”æ’è¡Œæ¦œ  
	ads_conn_ratio_day_top
ã€ä½“ç°æ¯æ¡çº¿çš„æ·±åœ³é€šä¹˜è½¦å¡æ™®åŠç¨‹åº¦ 9.5 æŠ˜ä¼˜æƒ ã€‘ å‡ºç«™äº¤æ˜“ä¼˜æƒ äººæ•°ç™¾åˆ†æ¯”æ’è¡Œæ¦œ     
	ads_line_sale_ratio_top
ã€ä½“ç°æ¢ä¹˜çš„å¿ƒé…¸ã€‘ æ¢ä¹˜è€—æ—¶æœ€ä¹…çš„ä¹˜å®¢æ’è¡Œæ¦œ	
	ads_conn_spend_time_top
ã€ä½“ç°çº¿è·¯æ‹¥æŒ¤ç¨‹åº¦ã€‘ ä¸Šè½¦ä»¥åè¿˜æ²¡ä¸‹è½¦ï¼Œæ¯åˆ†é’Ÿã€å°æ—¶æ¯æ¡çº¿åœ¨çº¿äººæ•°   
	ads_on_line_min_top
```

#### 3.3- ç¬¬ä¸‰æ­¥ï¼šå»ºåº“å»ºè¡¨è®¡ç®—æŒ‡æ ‡  
hdfs å…³é—­æƒé™æ£€æŸ¥ã€‚hive è®¾ç½®ä¿å­˜ç›®å½• /warehouseï¼›  
hue åˆ›å»º hue ç”¨æˆ·ï¼Œèµ‹äºˆè¶…çº§ç»„ã€‚hue åˆ‡æ¢åˆ° hue ç”¨æˆ·ï¼Œæ‰§è¡Œ hive sql å»ºåº“ sztï¼›  
åº“ä¸‹é¢å»ºç›®å½• ods dwd dws adsï¼›  

ä¸Šä¼ åŸå§‹æ•°æ®åˆ° /warehouse/szt.db/ods/  
szt-etl-data.csv szt-etl-data_2018-09-01.csv szt-page.jsons  

æŸ¥çœ‹ï¼š `hdfs dfs -ls -h  hdfs://cdh231:8020/warehouse/szt.db/ods/`

æ¥ä¸‹æ¥ä½¿ç”¨ HUE æŒ‰ç…§ `sql/hive.sql` ä¾æ¬¡æ‰§è¡Œ HQL è¯­å¥.....  

> ä¹Ÿå¯ä»¥ä½¿ç”¨ IDEA Database å·¥å…·æ æ“ä½œï¼Œé™„é€idea cdh hive å®Œç¾é©±åŠ¨ <https://github.com/timveil/hive-jdbc-uber-jar/releases>ï¼š  
![](.file/.pic/idea-dev+hive.png)

> ä¹Ÿå¯ä»¥ä½¿ç”¨ DBeaver ï¼ˆæˆ‘åªæƒ³è¯´ï¼Œ ä¸Šå¤äº§å“ Sqlyogã€navicatã€heidisqlã€workbench å…¨éƒ½æ˜¯æˆ˜äº”æ¸£ï¼‰ï¼Œå› ä¸ºæœ‰æ—¶å€™å¤æ‚çš„æŸ¥è¯¢å¯ä»¥ä¸€è¾¹æ‰§è¡Œä¸€è¾¹åœ¨å¦ä¸€ä¸ªå®¢æˆ·ç«¯å·¥å…·æŸ¥çœ‹ç»“æœï¼Œè¿™å¯¹äºå¤æ‚çš„åµŒå¥—æŸ¥è¯¢ debug éå¸¸æœ‰åŠ©äºåˆ†æå’Œè·Ÿè¸ªé—®é¢˜ã€‚DBeaver å®¢æˆ·ç«¯è‡ªå¸¦å›¾è¡¨ï¼Œä¸è¿‡æ²¡æœ‰ HUE å¥½çœ‹ï¼š   
![](.file/.pic/dbeaver-dev+hive.png)

---

å·²ç»å®Œæˆçš„æŒ‡æ ‡åˆ†æï¼š  

---  

##### 3.3.1 - æ·±åœ³åœ°é“è¿›ç«™äººæ¬¡æ’è¡Œæ¦œï¼š  
**2018-09-01ï¼Œå½“å¤©ä¾æ¬¡ä¸ºï¼šäº”å’Œã€å¸ƒå‰ã€ä¸¹ç«¹å¤´ï¼Œæ•°æ®è¯´æ˜å½“å¤©è¿™å‡ ä¸ªç«™ç‚¹è¿›ç«™äººæ•°æœ€å¤šã€‚**  

![](.file/.pic/.ads/ads_in_station_day_top.png)

![](.file/.pic/.ads/ads_in_station_day_top2.png)

---  

##### 3.3.2 - æ·±åœ³åœ°é“å‡ºç«™äººæ¬¡æ’è¡Œæ¦œï¼š  
**2018-09-01ï¼Œå½“å¤©å‡ºç«™ä¹˜å®¢ä¸»è¦å»å‘åˆ†åˆ«ä¸ºï¼šæ·±åœ³åŒ—é«˜é“ç«™ã€ç½—æ¹–ç«è½¦ç«™ã€ç¦ç”°å£å²¸ã€‚**

![](.file/.pic/.ads/ads_out_station_day_top.png)

![](.file/.pic/.ads/ads_out_station_day_top2.png)

---  

##### 3.3.3- æ·±åœ³åœ°é“è¿›å‡ºç«™æ€»äººæ¬¡æ’è¡Œæ¦œï¼š  
**2018-09-01ï¼Œå½“å¤©è½¦ç«™ååé‡æ’è¡Œæ¦œï¼š  
äº”å’Œç«™ï¼Ÿï¼Ÿï¼Ÿã€å¸ƒå‰ç«™ï¼ˆæ·±åœ³ä¸œç«è½¦ç«™ï¼‰ã€ç½—æ¹–ç«™ï¼ˆæ·±åœ³ç«è½¦ç«™ï¼‰ã€æ·±åœ³åŒ—ï¼ˆæ·±åœ³åŒ—é«˜é“ç«™ï¼‰ã€‚ã€‚ã€‚  
äº”å’Œç«™ä¸ºä»€ä¹ˆè¿™ä¹ˆç§€ï¼Ÿï¼Ÿï¼Ÿ  ğŸš€**    

![](.file/.pic/.ads/ads_in_out_station_day_top.png)

---  

##### 3.3.4- æ·±åœ³åœ°é“ä¹˜å®¢è½¦è´¹æ’è¡Œæ¦œï¼š  
**2018-09-01ï¼Œå½“å¤©è½¦è´¹æœ€é«˜çš„ä¹˜å®¢èŠ±äº† 48 å…ƒäººæ°‘å¸  
ğŸš„ğŸš„ğŸš„ è¯´æ˜ï¼šæ·±åœ³é€šåœ°é“å¡ä¸è®°åï¼Œæœªæ¶‰åŠä¸ªäººéšç§ï¼ï¼ï¼**  

![](.file/.pic/.ads/ads_card_deal_day_top.png)

---  

##### 3.3.5- æ·±åœ³åœ°é“å„çº¿è·¯å•æ—¥å‘é€æ—…å®¢æ’è¡Œæ¦œï¼š  
**2018-09-01ï¼Œå½“å¤©äº”å·çº¿å®¢è¿é‡é¥é¥é¢†å…ˆï¼Œé¾™å²—çº¿ç¢¾å‹ä¸€å·çº¿ï¼Œå¿ƒç–¼é¾™å²—äººæ°‘ï¼ğŸ˜³**

![](.file/.pic/.ads/ads_line_send_passengers_day_top.png)

---  

##### 3.3.6- æ·±åœ³åœ°é“æ¯æ—¥è¿è¾“ä¹˜å®¢æœ€å¤šçš„åŒºé—´æ’è¡Œæ¦œï¼š  
**2018-09-01å½“å¤©å‰ä¸‰ååˆ†åˆ«æ˜¯ï¼šèµ¤å°¾>åå¼ºåŒ—ï¼Œç¦æ°‘>ç¦ç”°å£å²¸ï¼Œäº”å’Œ>æ·±åœ³åŒ—**

![](.file/.pic/.ads/ads_stations_send.png)

---

##### 3.3.7- æ·±åœ³åœ°é“æ¯æ¡çº¿è·¯å•ç¨‹ç›´è¾¾ä¹˜å®¢è€—æ—¶å¹³å‡å€¼æ’è¡Œæ¦œï¼š
**2018-09-01ï¼Œå½“å¤©äº”å·çº¿å•ç¨‹ç›´è¾¾ä¹˜å®¢å¹³å‡è€—æ—¶1500sï¼Œçº¦åˆ25åˆ†é’Ÿï¼Œå¹³å‡å€¼æœ€é•¿çš„æ˜¯ 11å·çº¿ï¼Œå¹³å‡è€—æ—¶ 40 åˆ†é’Ÿ**

![](.file/.pic/.ads/ads_line_single_ride_average_time_day_top.png)

---

##### 3.3.8- æ·±åœ³åœ°é“æ‰€æœ‰ä¹˜å®¢é€šå‹¤æ—¶é—´å¹³å‡å€¼ï¼š
**2018-09-01ï¼Œå½“å¤©æ‰€æœ‰ä¹˜å®¢é€šå‹¤æ—¶é—´å¹³å‡å€¼ 1791 sï¼Œçº¦åˆ 30 åˆ†é’Ÿ**

![](.file/.pic/.ads/ads_all_passengers_single_ride_spend_time_average.png)

---

##### 3.3.9- æ·±åœ³åœ°é“æ‰€æœ‰ä¹˜å®¢é€šå‹¤æ—¶é—´æ’è¡Œæ¦œï¼š
**2018-09-01ï¼Œå½“å¤©æ‰€æœ‰ä¹˜å®¢é€šå‹¤æ—¶é—´æ’è¡Œæ¦œï¼Œç«™å†…æ»ç•™æœ€ä¹…çš„ä¹˜å®¢é—´éš” 17123 ç§’ï¼Œçº¦åˆ 4.75 å°æ—¶ï¼Œå®é™…æƒ…å†µåªéœ€è¦ 20 åˆ†é’Ÿè½¦ç¨‹ï¼Œéš¾é“æ˜¯è¿›ç«™æäº‹æƒ…ï¼Ÿï¼Ÿï¼Ÿ**
![](.file/.pic/kibana-search-card-1.png)
![](.file/.pic/baiduMap1.png)

![](.file/.pic/.ads/ads_passenger_spend_time_day_top.png)

---

##### 3.3.10- æ·±åœ³åœ°é“æ¯ä¸ªç«™ç‚¹è¿›å‡ºç«™é—¸æœºæ•°é‡æ’è¡Œæ¦œï¼š
**2018-09-01ï¼Œå½“å¤©ç¦ç”°ç«™åŒé¡¹ç¬¬ä¸€**

![](.file/.pic/.ads/ads_station_in_equ_num_top.png)
![](.file/.pic/.ads/ads_station_out_equ_num_top.png)

---

##### 3.3.11- æ·±åœ³åœ°é“å„çº¿è·¯è¿›å‡ºç«™é—¸æœºæ•°é‡æ’è¡Œæ¦œï¼š
**2018-09-01ï¼Œå½“å¤©æ·±åœ³åœ°é“ä¸€å·çº¿é•¿è„¸äº†@_@ï¼Œä¸¤ä¸ªæŒ‡æ ‡éƒ½æ˜¯ç¬¬ä¸€ï¼Œæ¸¯é“å››å·çº¿å…¨éƒ¨å«åº•ï¼Œåå¦ˆå…»çš„ï¼Ÿï¼Ÿï¼Ÿ**

![](.file/.pic/.ads/ads_line_in_equ_num_top.png)
![](.file/.pic/.ads/ads_line_out_equ_num_top.png)

---

##### 3.3.12- æ·±åœ³åœ°é“å„ç«™æ”¶å…¥æ’è¡Œæ¦œï¼š
**2018-09-01ï¼Œå½“å¤©ä¸Šåˆæ·±åœ³åŒ—ç«™æ”¶å…¥ 4 ä¸‡å…ƒäººæ°‘å¸ï¼Œæ’åç¬¬ä¸€**
![](.file/.pic/.ads/ads_station_deal_top.png)

---

##### 3.3.12- æ·±åœ³åœ°é“å„çº¿è·¯æ”¶å…¥æ’è¡Œæ¦œï¼š
**2018-09-01ï¼Œæ•°æ®æ˜¾ç¤ºä¸€å·çº¿ä¾ç„¶æ˜¯æ·±åœ³åœ°é“æœ€å¤šæ”¶å…¥çš„çº¿è·¯ï¼Œ1å·çº¿ä¸Šåˆæ”¶å…¥ 30 ä¸‡å…ƒäººæ°‘å¸ï¼Œå…¶æ¬¡æ˜¯äº”å·çº¿ç´§éšå…¶å**
![](.file/.pic/.ads/ads_line_deal_top.png)

---

##### 3.3.13- æ·±åœ³åœ°é“å„çº¿è·¯æ¢ä¹˜å‡ºç«™ä¹˜å®¢ç™¾åˆ†æ¯”æ’è¡Œæ¦œï¼š  
**æ¢ä¹˜åä»äº”å·çº¿å‡ºæ¥çš„ä¹˜å®¢æ˜¯å æ¯”æœ€é«˜çš„ 15.6%ï¼Œä»ä¹å·çº¿å‡ºç«™çš„ä¹˜å®¢ï¼Œæ¢ä¹˜æ¯”ä¾‹æœ€ä½ï¼Œä»… 9.42%**
![](.file/.pic/.ads/ads_conn_ratio_day_top.png)

---

##### 3.3.14- æ·±åœ³åœ°é“å„çº¿è·¯ç›´è¾¾ä¹˜å®¢ä¼˜æƒ äººæ¬¡ç™¾åˆ†æ¯”æ’è¡Œæ¦œï¼š  
**ç›®å‰å¯ä»¥ç¡®å®šçš„æ˜¯ï¼ŒæŒæœ‰æ·±åœ³é€šåœ°é“å¡å¯ä»¥äº«å—9.5æŠ˜ä¼˜æƒ ä¹˜ååœ°é“ï¼Œä»ç»Ÿè®¡ç»“æœçœ‹ï¼Œ2018-09-01å½“å¤©ï¼Œä¸ƒå·çº¿ä½¿ç”¨åœ°é“å¡ä¼˜æƒ çš„ä¹˜å®¢äººæ¬¡å æ¯”æœ€é«˜ï¼Œè¾¾åˆ° 90.36%ï¼Œæ’åæœ€ä½çš„æ˜¯äº”å·çº¿ï¼Œå æ¯” 84.3%**
![](.file/.pic/.ads/ads_line_sale_ratio_top.png)

---

##### 3.3.15- æ·±åœ³åœ°é“æ¢ä¹˜æ—¶é—´æœ€ä¹…çš„ä¹˜å®¢æ’è¡Œæ¦œï¼š  
**ç»Ÿè®¡è¿‡ç¨‹å‘ç°éš¾ä»¥ç†è§£çš„ç°è±¡ï¼Œæœ‰å‡ ä¸ªä¹˜å®¢è¿›ç«™ä»¥åï¼Œæ²¡æœ‰åˆ·å¡å‡ºç«™å°±æ¢ä¹˜äº†å…¬äº¤è½¦ï¼Œäºæ˜¯å‡ºç°äº†åŒä¸€ä¸ªåœ°é“ç«™è¿›å‡ºç«™ï¼Œä½†æ˜¯æ ‡è®°ä¸ºè”ç¨‹çš„è®°å½•**

![](.file/.pic/WTF.png)
![](.file/.pic/.ads/ads_conn_spend_time_top.png)

---

### 4- æ–°å¢æ¨¡å—ï¼šSZT-kafka-hbase  
SZT-kafka-hbase project for Spring Boot2  
çœ‹è¿‡å¼€æºçš„ spring-boot-starter-hbaseã€spring-data-hadoop-hbaseï¼ŒåŸºç¡€ä¾èµ–è¿‡äºè€æ—§ï¼Œé•¿æœŸä¸æ›´æ–°ï¼›å¼•å…¥è¿‡ç¨‹ç¹çï¼Œè€Œä¸” API ç²’åº¦å—é™ï¼›æ•°æ®åº“è¿æ¥æ²¡æœ‰å¤ç”¨ï¼Œå¯¼è‡´æ•°æ®åº“æœåŠ¡è¯»å†™æˆæœ¬å¤ªé«˜ã€‚

äºæ˜¯è‡ªå·±å®ç°äº† hbase-2.1 + springboot-2.1.13 + kafka-2.0 çš„é›†æˆï¼Œä¸€ä¸ªé•¿ä¼šè¯å®Œæˆ hbase è¿ç»­çš„å¢åˆ æ”¹æŸ¥ğŸ‘‘ğŸ‘‘ğŸ‘‘ï¼Œé™ä½æœåŠ¡å™¨èµ„æºçš„å¼€é”€ã€‚

![](SZT-kafka-hbase/.pic/hbase666.png)

ä¸»è¦ç‰¹è‰²ï¼š  

- knife4j åœ¨çº¿è°ƒè¯•ï¼Œç‚¹å‡»é¼ æ ‡å³å¯å®Œæˆ hbase å†™å…¥å’ŒæŸ¥è¯¢ï¼Œå†ä¹Ÿä¸ç”¨è®°ä½ç¹ççš„å‘½ä»¤ğŸ˜ğŸ˜ğŸ˜ã€‚

- hbase åˆ—æ—ç‰ˆæœ¬å†å²è®¾ç½®ä¸º 10ï¼Œæ”¯æŒé…ç½®æ–‡ä»¶çº§åˆ«çš„ä¿®æ”¹ã€‚å¯ä»¥æŸ¥è¯¢æŸå¡å·æœ€è¿‘ 10 æ¬¡äº¤æ˜“è®°å½•ã€‚

- hbase rowkey è®¾è®¡ä¸ºå¡å·åè½¬ï¼Œä½¿å¾—å­—å…¸æ’åºè¿‡ç¨‹æ¶ˆè€—çš„æœåŠ¡å™¨ç®—åŠ›åœ¨åˆ†å¸ƒå¼ç¯å¢ƒæ›´åŠ å‡è¡¡ã€‚

- å…¨è‡ªåŠ¨çš„å»ºåº“å»ºè¡¨ã€æœ¬é¡¹ç›®çš„ hbase å‘½åç©ºé—´ä¸º sztã€‘ï¼Œå®ç°å¹‚ç­‰æ“ä½œï¼Œæ— éœ€æ‹…å¿ƒ hbase æ•°æ®åº“çš„æ±¡æŸ“ã€‚

æ•ˆæœå±•ç¤ºï¼š  

- å‡†å¤‡éƒ¨ç½²å®Œæˆçš„ hbaseï¼Œé€‚å½“ä¿®æ”¹æœ¬é¡¹ç›®é…ç½®æ–‡ä»¶ï¼Œè¿è¡Œ SZT-kafka-hbase é¡¹ç›®ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š  

å¯åŠ¨ï¼š  
![](SZT-kafka-hbase/.pic/hbase-run.png)

api-debugï¼Œéšä¾¿å†™ç‚¹ä¸œè¥¿è¿›å»ï¼Œç‹‚ç‚¹å‘é€ã€‚èƒ½å†™å¤šå¿«å°±è€ƒéªŒä½ çš„æ‰‹é€Ÿäº†ğŸ˜ğŸ˜ğŸ˜ï¼š  
![](SZT-kafka-hbase/.pic/hbase-api-debug.png)

hue-hbase æŸ¥è¡¨ï¼š  
![](SZT-kafka-hbase/.pic/hue-hbase-szt.png)

hue-hbase æŸ¥çœ‹å†å²ç‰ˆæœ¬ï¼š  
![](SZT-kafka-hbase/.pic/hue-hbase-szt-versions-10.png)

hbase-shell å‘½ä»¤ï¼š  
å…¨è¡¨æ‰«æï¼Œè¿”å›åä¸ªç‰ˆæœ¬æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²æ˜¾ç¤ºï¼Œå‹æ¦¨æœåŠ¡å™¨æ€§èƒ½çš„æ—¶å€™åˆ°å•¦ï¼ï¼ï¼ğŸ˜ğŸ˜ğŸ˜   
`scan 'szt:data', {FORMATTER => 'toString',VERSIONS=>10}`

![](SZT-kafka-hbase/.pic/hbase-shell-toString.png)

---

- æ¥ä¸‹æ¥æ¥å…¥ kafka ğŸ¯ğŸ¯ğŸ¯  
å¯åŠ¨ `cn.java666.etlflink.app.Redis2Kafka`ï¼Œç”Ÿäº§æ¶ˆæ¯ï¼Œé€‚å½“è°ƒæ…¢ç”Ÿäº§é€Ÿåº¦ï¼Œä»¥å…æœºå™¨å´©æºƒã€‚  
ä¸å‡ºæ„å¤–çš„è¯ï¼Œä½ ä¼šçœ‹åˆ° SZT-kafka-hbase é¡¹ç›®çš„æ§åˆ¶å°æ‰“å°äº†æ—¥å¿—ï¼š  

![](.file/.pic/kafka2hbase.png)

å¦‚æœ hbase å´©æºƒäº†ï¼Œçœ‹çœ‹å†…å­˜å¤Ÿä¸å¤Ÿï¼Œæˆ‘å°±ç›´æ¥æ€¼ä¸Š 2GB X 3 ä¸ªèŠ‚ç‚¹ğŸŒŸğŸŒŸğŸŒŸï¼š  

![](SZT-kafka-hbase/.pic/hbase-2GB.png)

### 5- `SZT-flink` æ¨¡å—æ–°å¢ `cn.java666.etlflink.app.Json2HBase`  
å®ç°äº†ä» redis æˆ–è€…å…¶ä»–æ•°æ®æºå–å‡º json ä¸²ï¼Œä¿å­˜åˆ° hbase è¡¨ã€‚æœ¬é¡¹ç›®ä¸­ä» redis è·å– jsonï¼ˆå½“ç„¶æ›´æ¨è kafkaï¼‰ï¼Œé€šè¿‡ flink æ¸…æ´—å­˜åˆ° hbase flink:flink2hbase è¡¨ä¸­ã€‚ç”¨äºå®æ—¶ä¿å­˜æ·±åœ³é€šåˆ·å¡è®°å½•ï¼Œé€šè¿‡å¡å·æŸ¥è¯¢å¯ä»¥è·å–å¡å·æœ€è¿‘10æ¬¡ï¼ˆå¦‚æœæœ‰10æ¬¡ï¼‰äº¤æ˜“è®°å½•ã€‚  

![](.file/.pic/flink2hbase.png)

> ç®€åŒ–äº†ä¸Šä¸€ç‰ˆ hbase å†™å…¥ bean çš„æ–¹å¼ï¼ŒJSON å†ä¸€æ¬¡èµ¢å¾—æŒå£°ğŸ˜ğŸ˜ğŸ˜ã€‚

```scala
val keys = jsonObj.keySet().toList
val size = keys.size()

for (i <- 0 until size) {
	val key = keys.get(i)
	val value = jsonObj.getStr(key)
	putCell(card_no_re, cf, key, value)
}
```

--- 

### 6- æ–°å¢å®æ—¶å¤„ç†æ¨¡å— SZT-flink
å®Œæˆ flink è¯»å– kafkaï¼Œå­˜åˆ° clickhouse åŠŸèƒ½ã€‚  

![](.file/.pic/clickhouse-tabix.png)

![](.file/.pic/clickhouse-sql.png)

---

...ç»§ç»­å¼€å‘ä¸­ğŸ› ğŸ› ğŸ› ...

---

## TODOğŸ””ğŸ””ğŸ””:
- [x] è§£æ redis pageJsonï¼Œè½¬æ¢æ•°æ®æ ¼å¼ä¸ºæœ€å°æ•°æ®å•å…ƒå­˜åˆ° csvï¼Œå‡å°‘åŸå§‹æ•°æ®çš„å†—ä½™å­—ç¬¦ï¼Œæ–¹ä¾¿å­˜å–å’Œä¼ è¾“ã€‚ä¸°å¯Œæ•°æ®æºçš„æ ¼å¼ï¼Œå…¼å®¹æ›´å¤šçš„å®ç°æ–¹æ¡ˆï¼› 
- [x] æ¨é€ kafkaï¼Œä½¿ç”¨é˜Ÿåˆ—ä¼ è¾“æ•°æ®ï¼›
- [x] å­˜å…¥ elasticsearchï¼Œä½¿ç”¨å…¨æ–‡æ£€ç´¢å®ç°å®æ—¶æœç´¢ï¼Œkibana å¯è§†åŒ–å±•ç¤ºï¼› 
- [x] æ•°ä»“å»ºæ¨¡ï¼šODSã€DWDã€DWSã€ADS
- [x] hive on spark æ•°ä»“å»ºæ¨¡ã€åˆ†æè®¡ç®—ï¼›  
- [x] spark on hiveï¼Œæœ¬åœ°å¼€å‘ spark ç¨‹åºï¼Œæ“ä½œè¿œç¨‹ hive æ•°æ®åº“ï¼›  
- [ ] åˆ·å¡è®°å½•å®æ—¶å†™å…¥ hbaseï¼Œæ”¯æŒæœ€è¿‘äº¤æ˜“è®°å½•çš„æŸ¥è¯¢ï¼›   
- [-] ~~oozie è°ƒåº¦ï¼Œæ•°æ®å¤ªå°‘å•Š å˜¤å˜¤å˜¤~~ğŸ˜®ğŸ˜®ğŸ˜®;  
- [ ] å®æ—¶æ€è·¯åˆ†ææ•°æ®ï¼šflink æµå¼å®æ—¶åˆ†ææ—©æ™šé«˜å³°ç«™ç‚¹å‹åŠ›æ’è¡Œï¼›  
- [ ] ç¦»çº¿æ€è·¯åˆ†ææ•°æ®ï¼šspark å¾®æ‰¹å¤„ç†ï¼›
- [ ] DataV å¯è§†åŒ–å¤§å±å±•ç¤ºï¼›  

---


## æ›´æ–°æ—¥å¿—ğŸŒ¥ï¼š
- 2020-05-25ï¼š
	- flink å®æ—¶æµå¤„ç†åŠŸèƒ½éƒ¨åˆ†ä¸Šçº¿ã€‚å®Œæˆ flink è¯»å– kafkaï¼Œå­˜åˆ° clickhouse æ¨¡å—ï¼›
	- è¡¥å……ç¬¬ä¸€æœŸå¼€å‘è®¡åˆ’æ¶æ„å›¾ï¼›
	- ä¸‹ä¸€æ­¥ï¼Œè®¡åˆ’å¼€å‘æ•°æ®æ¹–ä¸­å°è§£å†³æ–¹æ¡ˆï¼Œè§„æ¨¡æ¯”è¾ƒå¤§ã€‚ç›®å‰è¿™ä¸ªé¡¹ç›®å·²ç»åˆç°é›å½¢ï¼ŒçŸ­æœŸå†…ä»¥ç»´æŠ¤å’Œä¼˜åŒ–ä¸ºä¸»ã€åŸåˆ™å°±æ˜¯å…ˆä¸Šçº¿åè¿­ä»£ã€‘ï¼›

- 2020-05-22:
	- è¡¥å……ç¬¬ä¸€æœŸå¼€å‘è®¡åˆ’çš„æ¶æ„å›¾ï¼Œå¸®åŠ©ç†è§£æ•´ä¸ªä¸šåŠ¡æµç¨‹ï¼›

- 2020-05-14ï¼š
	- `RedisSinkPageJson` ä» `package cn.java666.etlflink.sink` ç§»åˆ° `package cn.java666.etlflink.app` æ›´åä¸º `Jsons2Redis`ï¼Œæ–¹ä¾¿å½’ç±»ï¼Œè¯¥æ¨¡å—ç”¨äºè§£æåŸå§‹æ•°æ®å¤šè¡Œjsonåˆ°redisï¼›

- 2020-05-01ï¼š  
	- å®ç°äº†ä» redis æˆ–è€…å…¶ä»–æ•°æ®æºå–å‡º json ä¸²ï¼Œä¿å­˜åˆ° hbase è¡¨ï¼›  
	- å®ç°äº† hbase-2.1 + springboot-2.1.13 + kafka-2.0 çš„é›†æˆï¼›  
	- å®æ—¶æ¶ˆè´¹ kafka æ¶ˆæ¯å­˜åˆ° hbase æ•°æ®åº“ï¼Œæ”¯æŒå®æ—¶æŸ¥è¯¢æŸå¡å·æœ€è¿‘ n æ¬¡äº¤æ˜“è®°å½•ï¼›  

- 2020-04-30ï¼š  
	- å®ç°äº† hbase-2.1 + springboot-2.1.13 çš„é›†æˆï¼Œä¸€ä¸ªé•¿ä¼šè¯å®Œæˆ hbase è¿ç»­çš„å¢åˆ æ”¹æŸ¥ğŸ‘‘ğŸ‘‘ğŸ‘‘ï¼Œé™ä½æœåŠ¡å™¨èµ„æºçš„å¼€é”€ã€‚
	

- 2020-04-27ï¼š  
	- å½»åº•çš„è§£å†³äº†é™æ€èµ„æºæ— æ³•çƒ­éƒ¨ç½²çš„é—®é¢˜ï¼›  
```
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-devtools</artifactId>
	<scope>runtime</scope>
	<optional>true</optional>
</dependency>

######################### å®æ—¶çƒ­éƒ¨ç½² ###################################
#"å…³é—­ç¼“å­˜, å³æ—¶åˆ·æ–°"
spring.freemarker.cache=false
spring.thymeleaf.cache=false

#çƒ­éƒ¨ç½²ç”Ÿæ•ˆ
spring.devtools.restart.enabled=true
#æ˜¯å¦æ”¯æŒlivereload
spring.devtools.livereload.enabled=true
#è®¾ç½®é‡å¯çš„ç›®å½•,æ·»åŠ é‚£ä¸ªç›®å½•çš„æ–‡ä»¶éœ€è¦restart
spring.devtools.restart.additional-paths=src/main/*
#è®¾ç½®ä¸éœ€è¦é‡å¯çš„ç›®å½•
#spring.devtools.restart.exclude=static/**,public/**
```

- 202-04-27:  
	- å®Œæˆæ‰€æœ‰çº¿è·¯è§„åˆ’+æ¢ä¹˜æ–¹æ¡ˆçš„æŠ“å–å…¥åº“ï¼Œåˆè®¡ 45932 æ¡ï¼›  
	- è§£å†³äº† hive æ³¨é‡Šä¹±ç é—®é¢˜ï¼›  
```
alter table COLUMNS_V2 modify column COMMENT varchar(256) character set utf8;
alter table TABLE_PARAMS modify column PARAM_VALUE varchar(4000) character set utf8;
alter table PARTITION_PARAMS  modify column PARAM_VALUE varchar(4000) character set utf8;
alter table PARTITION_KEYS  modify column PKEY_COMMENT varchar(4000) character set utf8;
alter table  INDEX_PARAMS  modify column PARAM_VALUE  varchar(4000) character set utf8;
```

- 2020-04-24ï¼š
	- å®Œæˆæ–°çš„æŒ‡æ ‡è®¡ç®—ä»»åŠ¡ï¼šæ·±åœ³åœ°é“å„çº¿è·¯æ¢ä¹˜å‡ºç«™ä¹˜å®¢ç™¾åˆ†æ¯”æ’è¡Œæ¦œï¼›  
	- å®Œæˆæ–°çš„æŒ‡æ ‡è®¡ç®—ä»»åŠ¡ï¼šæ·±åœ³åœ°é“å„çº¿è·¯ç›´è¾¾ä¹˜å®¢ä¼˜æƒ äººæ¬¡ç™¾åˆ†æ¯”æ’è¡Œæ¦œï¼›  

- 2020-04-23ï¼š
	- å®Œæˆæ–°çš„æŒ‡æ ‡è®¡ç®—ä»»åŠ¡ï¼šæ·±åœ³åœ°é“å„çº¿è·¯å•ç¨‹ç›´è¾¾ä¹˜å®¢è€—æ—¶å¹³å‡å€¼æ’è¡Œæ¦œï¼›  
	- å®Œæˆæ–°çš„æŒ‡æ ‡è®¡ç®—ä»»åŠ¡ï¼šæ·±åœ³åœ°é“æ‰€æœ‰ä¹˜å®¢é€šå‹¤æ—¶é—´å¹³å‡å€¼ï¼›   
	- å®Œæˆæ–°çš„æŒ‡æ ‡è®¡ç®—ä»»åŠ¡ï¼šæ·±åœ³åœ°é“æ‰€æœ‰ä¹˜å®¢é€šå‹¤æ—¶é—´æ’è¡Œæ¦œï¼ˆå€’åºï¼‰ï¼›   
	- å®Œæˆæ–°çš„æŒ‡æ ‡è®¡ç®—ä»»åŠ¡ï¼šæ·±åœ³åœ°é“å„ç«™ç‚¹ã€çº¿è·¯ï¼Œè¿›ç«™ã€å‡ºç«™é—¸æœºæ•°æ’è¡Œæ¦œï¼›  
	- å®Œæˆæ–°çš„æŒ‡æ ‡è®¡ç®—ä»»åŠ¡ï¼šæ·±åœ³åœ°é“å„ç«™ç‚¹ã€çº¿è·¯ï¼Œæ”¶å…¥æ’è¡Œæ¦œï¼›  

- 2020-04-22ï¼š
	- æ›´æ–°æ–‡æ¡£ï¼›  
	- å®Œæˆæ–°çš„æŒ‡æ ‡è®¡ç®—ä»»åŠ¡ï¼šæ¯æ—¥è¿è¾“ä¹˜å®¢æœ€å¤šçš„åŒºé—´æ’è¡Œæ¦œï¼›  
	
- 2020-04-21:
	- æ–°å¢æ¨¡å—ï¼šSZT-spark-hiveï¼Œæœ¬åœ°å¼€å‘ spark ç¨‹åºï¼Œæ“ä½œè¿œç¨‹ Hive æ•°æ®åº“ï¼›  
	- Debugï¼šspark on hive æœ¬åœ°å¼€å‘ï¼Œè¿œç¨‹æäº¤ yarn è¸©å‘ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç¼“è§£å¼€å‘ä¸»æœºçš„å‹åŠ›ï¼›  

- 2020-04-20ï¼š
	- æ›´æ–°é¡¹ç›®æ–‡æ¡£ï¼›  
	- è‡ªåˆ¶é¡¹ç›® logoï¼›  
	- ç»§ç»­å†™ SQL è®¡ç®—æ–°æŒ‡æ ‡ï¼Œæœ¬æ‰“ç®—åˆ‡åˆ° hive 3.1 ä½¿ç”¨ TEZ å¼•æ“ï¼Œä½†æ˜¯ hive on spark é€Ÿåº¦å·²ç»å¾ˆç»™åŠ›äº†ï¼Œè‡³å°‘æ˜¯ MR å¼•æ“çš„ 10 å€é€Ÿåº¦ï¼Œå…ˆç”¨ç€ï¼›  

- 2020-04-19ï¼š
	- vmware è™šæ‹Ÿæœºæ‰©å®¹æ—¶è¯¯åˆ ç³»ç»Ÿæ–‡ä»¶`rm -rf /usr/` ğŸ¥µï¼Œå¥½åœ¨ HDFSã€Kafkaã€ES è‡ªå¸¦å‰¯æœ¬æœºåˆ¶ï¼Œè€Œä¸”å¤§éƒ¨åˆ†ä¸šåŠ¡æ•°æ®éƒ½æ˜¯æŒ‚è½½åˆ°å¤–éƒ¨ç£ç›˜ï¼Œæ‰€ä»¥é‡è¦æ•°æ®å’Œç»„ä»¶æ—¥å¿—åŸºæœ¬æ²¡ä¸¢ã€‚cdh é›†ç¾¤æ·»åŠ äº†æ–°çš„èŠ‚ç‚¹ï¼›  
	- æ¢å¤å·¥ä½œç¯å¢ƒï¼Œä» hive on MR åˆ‡æ¢åˆ° hive on sparkï¼›  

- 2020-04-18ï¼š
	- è§„åˆ’æ•°ä»“ï¼Œæ­å»ºæ•°ä»“ç¯å¢ƒï¼›  

- 2020-04-17  
	- ä¿®æ­£é”™åˆ«å­—ï¼›  
	- å‘å¸ƒv0.12;  
	
- 2020-04-16
	- é‡æ„é¡¹ç›®ï¼›
	- è¡¥å……æ–‡æ¡£
	- å‘å¸ƒv0.1 

- 2020-04-15  
	- å¢åŠ  common æ¨¡å—ï¼Œæ‹†åˆ†è§£è€¦ï¼›
	- æ”¯æŒè‡ªåŠ¨è¯†åˆ«å¡å·æ˜æ–‡å’Œå¯†æ–‡ï¼Œä¸€é”®äº’è½¬ï¼Œæä¾› REST APIï¼›  
	- ä¿®å¤ ES æ—¶åŒºå¯¼è‡´çš„é”™è¯¯ç»Ÿè®¡æ•°é‡ï¼›
	- Redis2Csv å®ç°äº†æŒ‰å¤©è½¬æ¢ csv å­˜ç›˜ï¼›

- 2020-04-14
	- é‡æ„ï¼›
	- å®Œæˆ csv æ ¼å¼æ–‡ä»¶çš„æŠ½å–ï¼›
	- æ·»åŠ  GPL-3 å¼€æºè¯ä¹¦ï¼Œé¼“åŠ±å¼€æºåˆ†å‘ï¼›
	- æ·»åŠ å¾½æ ‡ï¼› 
	- å®Œæˆå†™å…¥ ES æ•°æ®åº“ï¼Œæ·»åŠ æ—¶é—´æ˜ å°„,kibana å®æ—¶æŸ¥çœ‹åˆ·å¡æ•°æ®ç»Ÿè®¡æ›²çº¿çš„å˜åŒ–ï¼›
	
- 2020-04-13 
	- é¡¹ç›®åˆå§‹åŒ–ï¼›
	- å®Œæˆæ•°æ®æºæ¸…æ´—å»é‡ï¼Œå­˜åˆ° redisï¼›
	- å®Œæˆ redis æŸ¥è¯¢ REST API çš„å¼€å‘ï¼›
	- å®Œæˆ flink è‡ªå®šä¹‰ source redis çš„å¼€å‘ï¼Œå¹¶ä¸”æ›´ç»†ç²’åº¦æ¸…æ´—æºæ•°æ®ï¼›
	- å®Œæˆ æ¨é€æºæ•°æ®åˆ° kafkaï¼›

	
## è”ç³»ğŸ˜ªï¼š
æ¬¢è¿äº¤æµæŠ€æœ¯ï¼Œæ¥å¤´æš—å·`github`        
![](.file/.pic/0-wexin.png)

> ç™¾åº¦å’Œè°·æ­Œèƒ½æ‰¾åˆ°çš„é—®é¢˜å°±ä¸è¦å†é—®äº†ï¼å¾ˆç´¯çš„ğŸ˜•ğŸ˜•ğŸ˜•

## è¡¥å……ğŸ’ŒğŸ’ŒğŸ’Œï¼š
- ä¸å¼€å°å¯†åœˆï¼›
- ä¸å–è¯¾ã€ä¸å–æ•™ç¨‹ï¼›
- ä¸æ±‚èµï¼Œä¸æ±‚ç²‰ï¼›
- ä¸å‘å¹¿å‘Šã€ä¸éªšæ‰°ï¼›
- ä¸å‰²éŸ­èœ

> åšæŒåŸåˆ™å’Œåº•çº¿ã€‚

æ¯”å¿ƒğŸ¤ğŸ¤ğŸ¤  

## åä¸ªæ§½ğŸ¦ğŸ¦ğŸ¦ï¼š
ç¨‹åºå‘˜è¿™è¾ˆå­ä¸€å®šä¼šé‡åˆ°çš„ä¸‰ä¸ªé—®é¢˜ï¼š   

- ä¹±ç é—®é¢˜ğŸŒšï¼›  
- æ—¶åŒºä¸ä¸€è‡´é—®é¢˜ğŸŒ—ï¼›  
- è½¯ä»¶ç‰ˆæœ¬ä¸å…¼å®¹é—®é¢˜â„ï¼›  

## æ•™è®­ï¼š
- å¤§æ•°æ®ç¨‹åºå‘˜åƒä¸‡ä¸èƒ½ç”Ÿäº§é”™è¯¯çš„æ•°æ®ï¼Œå®¹å¿ç¨‹åºè¿è¡Œå¤±è´¥ã€ç”šè‡³æ²¡æœ‰è¾“å‡ºæ•°æ®ï¼Œå¤±è´¥äº†å¯ä»¥è·Ÿè¸ªåŸå› ï¼Œè‡³å°‘ä¸ä¼šæœ‰è„æ•°æ®ã€‚
- ä¸€æ—¦æ•°æ®é”™è¯¯ï¼Œä¼šå½±å“åé¢çš„æ‰€æœ‰è®¡ç®—æµç¨‹ï¼Œç”šè‡³å¯¼è‡´é”™è¯¯å†³ç­–ã€‚


## ä»“åº“ç»Ÿè®¡ï¼š
[![å…³æ³¨é‡](https://starchart.cc/geekyouth/SZT-bigdata.svg)](https://starchart.cc/geekyouth/SZT-bigdata)

[![æå®¢é’å¹´çš„ github statsï¼Œå«ä¸»é¢˜](https://github-readme-stats.vercel.app/api?username=geekyouth&show_icons=true&theme=monokai)](https://github.com/anuraghazra/github-readme-stats)

[![æå®¢é’å¹´çš„ github statsï¼ŒæŒ‡å®šä»“åº“](https://github-readme-stats.vercel.app/api/pin?username=geekyouth&repo=SZT-bigdata&show_icons=true&theme=monokai&show_owner=true)](https://github.com/anuraghazra/github-readme-stats)

[![JB logo](https://www.jetbrains.com/company/brand/img/logo1.svg)](https://www.jetbrains.com/?from=https://github.com/geekyouth/SZT-bigdata)
